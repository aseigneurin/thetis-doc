

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The merge command &mdash; Thetis 2.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Thetis 2.0 documentation" href="index.html"/>
        <link rel="next" title="Deploying thetis with Oozie" href="oozie.html"/>
        <link rel="prev" title="The refresh command" href="refresh.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Thetis
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="get-started.html">Get started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="get-started.html#commands">Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hdfs.html">The HDFS structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">The schema.json file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="schema.html#fields">Fields</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="infer-schema.html">The infer-schema command</a><ul>
<li class="toctree-l2"><a class="reference internal" href="infer-schema.html#input">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="infer-schema.html#output">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="infer-schema.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="create.html">The create command</a><ul>
<li class="toctree-l2"><a class="reference internal" href="create.html#input">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="create.html#output">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="create.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="clean.html">The clean command</a><ul>
<li class="toctree-l2"><a class="reference internal" href="clean.html#input">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="clean.html#output">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="clean.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="check.html">The check command</a><ul>
<li class="toctree-l2"><a class="reference internal" href="check.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="check.html#check-criteria">Check criteria</a></li>
<li class="toctree-l2"><a class="reference internal" href="check.html#output">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="check.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">The stats command</a><ul>
<li class="toctree-l2"><a class="reference internal" href="stats.html#input">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html#output">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="refresh.html">The refresh command</a><ul>
<li class="toctree-l2"><a class="reference internal" href="refresh.html#input">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="refresh.html#output">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="refresh.html#example">Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="refresh.html#delta-true">delta=true</a></li>
<li class="toctree-l3"><a class="reference internal" href="refresh.html#delta-false">delta=false</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">The merge command</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="oozie.html">Deploying thetis with Oozie</a><ul>
<li class="toctree-l2"><a class="reference internal" href="oozie.html#common-setup">Common setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="oozie.html#setting-up-an-engine">Setting up an engine</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Thetis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>The merge command</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/merge.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="the-merge-command">
<h1>The merge command<a class="headerlink" href="#the-merge-command" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal"><span class="pre">merge</span></code> command is alpha for now. It merge a dataset by replacing old data by new data.</p>
<div class="section" id="input">
<h2>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h2>
<p>You have to specify a dataset and a tenant</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>./thetis.sh --tenant my_tenant --dataset my_dataset merge
or
<span class="nv">$ </span>./thetis.sh -t my_tenant -d my_dataset merge
</pre></div>
</div>
</div>
<div class="section" id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">merge</span></code> command will merge all the files from the dataset. It implies that you must specify in your schema
the primary key(s) (<code class="docutils literal"><span class="pre">isPrimaryKey</span></code> field) and a timestamp (<code class="docutils literal"><span class="pre">isTimestamp</span></code>). If Thetis find several lines with the
same primary key it will only keep the most recent one according to the timestamp. If one of the two fields is not
set, Thetis won&#8217;t do anything. You can specify several primary keys.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of what a schema should look like if you want to merge a dataset :</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
  <span class="nt">&quot;hdfsRawDirectory&quot;</span> <span class="p">:</span> <span class="s2">&quot;/group/my_tenant/raw&quot;</span><span class="p">,</span>
  <span class="nt">&quot;hdfsDataDirectory&quot;</span> <span class="p">:</span> <span class="s2">&quot;/group/my_tenant/data/my_dataset&quot;</span><span class="p">,</span>
  <span class="nt">&quot;fileName&quot;</span> <span class="p">:</span> <span class="s2">&quot;rawData-yyyyMMdd.txt&quot;</span><span class="p">,</span>
  <span class="nt">&quot;charset&quot;</span> <span class="p">:</span> <span class="s2">&quot;UTF-8&quot;</span><span class="p">,</span>
  <span class="nt">&quot;delimiter&quot;</span> <span class="p">:</span> <span class="s2">&quot;¤&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dataDelimiter&quot;</span> <span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
  <span class="nt">&quot;delta&quot;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nt">&quot;filter&quot;</span> <span class="p">:</span> <span class="s2">&quot;HEADER&quot;</span><span class="p">,</span>
  <span class="nt">&quot;hiveTable&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;database&quot;</span> <span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;dataset&quot;</span><span class="p">,</span>
    <span class="nt">&quot;hiveFields&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
      <span class="nt">&quot;index&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;primary&quot;</span><span class="p">,</span>
      <span class="nt">&quot;colType&quot;</span> <span class="p">:</span> <span class="s2">&quot;STRING&quot;</span><span class="p">,</span>
      <span class="nt">&quot;isPrimaryKey&quot;</span> <span class="p">:</span> <span class="kc">true</span>
    <span class="p">},{</span>
      <span class="nt">&quot;index&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
      <span class="nt">&quot;colType&quot;</span> <span class="p">:</span> <span class="s2">&quot;STRING&quot;</span>
    <span class="p">},</span> <span class="p">{</span>
      <span class="nt">&quot;index&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span>
      <span class="nt">&quot;colType&quot;</span> <span class="p">:</span> <span class="s2">&quot;INTEGER&quot;</span>
    <span class="p">},</span> <span class="p">{</span>
      <span class="nt">&quot;index&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
      <span class="nt">&quot;colType&quot;</span> <span class="p">:</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span>
      <span class="nt">&quot;transformation&quot;</span> <span class="p">:</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span>
      <span class="nt">&quot;pattern&quot;</span> <span class="p">:</span> <span class="s2">&quot;yyyy-mm-dd&quot;</span><span class="p">,</span>
      <span class="nt">&quot;isTimestamp&quot;</span> <span class="p">:</span> <span class="kc">true</span>
    <span class="p">}]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="oozie.html" class="btn btn-neutral float-right" title="Deploying thetis with Oozie" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="refresh.html" class="btn btn-neutral" title="The refresh command" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, DIL.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>